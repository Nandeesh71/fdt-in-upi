{"ast":null,"code":"/**\r\n * BiometricSetup Component - Updated Version\r\n * Modal for registering biometric credentials (fingerprint/face)\r\n * Used on user dashboard after login\r\n */import React,{useState,useEffect}from'react';import{isPlatformAuthenticatorAvailable,registerBiometric}from'../utils/webauthn';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BiometricSetup=_ref=>{let{onComplete,onSkip}=_ref;const[isSupported,setIsSupported]=useState(false);const[isEnrolling,setIsEnrolling]=useState(false);const[error,setError]=useState(null);const[deviceName,setDeviceName]=useState('');const[checkingSupport,setCheckingSupport]=useState(true);useEffect(()=>{checkSupport();},[]);const checkSupport=async()=>{try{const available=await isPlatformAuthenticatorAvailable();setIsSupported(available);if(available){// Generate default device name\nconst now=new Date();const dateStr=now.toLocaleDateString();setDeviceName(\"Device - \".concat(dateStr));}}catch(err){console.error('Error checking biometric support:',err);setIsSupported(false);}finally{setCheckingSupport(false);}};const handleEnroll=async()=>{setIsEnrolling(true);setError(null);try{console.log('Starting biometric enrollment...');const result=await registerBiometric(deviceName||'Registered Device');console.log('Enrollment successful:',result);if(onComplete){onComplete();}}catch(err){console.error('Enrollment error:',err);// Parse error message\nconst errMsg=typeof err==='string'?err:(err===null||err===void 0?void 0:err.message)||'';let errorMessage='Failed to enable biometric authentication';if(errMsg.includes('Failed to fetch')||errMsg.includes('NetworkError')){errorMessage='Cannot connect to server. Please check your internet connection.';}else if(errMsg.includes('not authenticated')||errMsg.includes('No authentication token')){errorMessage='Please log in first before setting up biometric.';}else if(errMsg.includes('cancelled')){errorMessage='Biometric enrollment cancelled';}else if(errMsg.includes('not available')){errorMessage='Biometric authentication is not available on this device';}else if(errMsg.includes('timeout')){errorMessage='Registration timed out. Please try again.';}else{errorMessage=errMsg||errorMessage;}setError(errorMessage);}finally{setIsEnrolling(false);}};if(checkingSupport){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin inline-block h-8 w-8 border-4 border-indigo-600 border-r-transparent rounded-full\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-gray-600\",children:\"Checking biometric support...\"})]})});}if(!isSupported){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800 mb-3\",children:\"Biometric Not Available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"Your device doesn't support fingerprint or Face ID authentication. You can continue using password login.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onSkip,className:\"w-full bg-gray-500 text-white py-3 px-4 rounded-lg hover:bg-gray-600 transition-colors\",children:\"Continue with Password\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDC46\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-semibold text-gray-800 mb-2\",children:\"Enable Biometric Login\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Register your fingerprint or face for faster, secure authentication\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Device Name (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:deviceName,onChange:e=>setDeviceName(e.target.value),placeholder:\"e.g., My iPhone, Work Laptop\",className:\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500\",disabled:isEnrolling,autoFocus:true}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Helps you identify this device in security settings\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[\"\\u26A0\\uFE0F \",error]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 border border-blue-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-blue-900 mb-2\",children:\"Benefits:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-blue-800 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2713 Login in seconds with biometric\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2713 No need to remember passwords\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2713 More secure than passwords\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2713 12-hour trusted device session\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEnroll,disabled:isEnrolling,className:\"w-full py-3 px-4 rounded-lg text-white font-semibold transition-colors \".concat(isEnrolling?'bg-gray-400 cursor-not-allowed':'bg-indigo-600 hover:bg-indigo-700'),children:isEnrolling?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 mr-3\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\",fill:\"none\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Registering...\"]}):'Register Biometric'}),/*#__PURE__*/_jsx(\"button\",{onClick:onSkip,disabled:isEnrolling,className:\"w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors\",children:\"Skip for Now\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 text-center\",children:\"You can enable biometric later in Security Settings\"})]})]});};export default BiometricSetup;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}