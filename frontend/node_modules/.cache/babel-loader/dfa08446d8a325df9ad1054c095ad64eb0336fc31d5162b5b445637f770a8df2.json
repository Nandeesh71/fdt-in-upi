{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{isPlatformAuthenticatorAvailable,authenticateWithBiometric,hasStoredCredentials}from'../utils/webauthn';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BiometricLogin=_ref=>{let{phone,onSuccess,onFallbackToPassword}=_ref;const[isSupported,setIsSupported]=useState(false);const[isAuthenticating,setIsAuthenticating]=useState(false);const[error,setError]=useState(null);const[hasCredentials,setHasCredentials]=useState(false);useEffect(()=>{checkSupport();},[]);const checkSupport=async()=>{const available=await isPlatformAuthenticatorAvailable();const stored=hasStoredCredentials();setIsSupported(available);setHasCredentials(stored);};const handleBiometricLogin=useCallback(async()=>{if(!phone){setError('Please enter your phone number first');return;}setIsAuthenticating(true);setError(null);try{const result=await authenticateWithBiometric(phone);if(onSuccess){onSuccess(result);}}catch(err){console.error('Biometric login error:',err);// Check if it's a \"not enabled\" error\nif(err.message.includes('not enabled')||err.message.includes('No biometric')){setError('Biometric login not set up for this account');}else{setError(err.message||'Fingerprint authentication failed');}}finally{setIsAuthenticating(false);}},[phone,onSuccess]);// Auto-trigger biometric if credentials exist and phone is entered\nuseEffect(()=>{if(isSupported&&hasCredentials&&phone&&!isAuthenticating&&!error){// Small delay to avoid immediate trigger\nconst timer=setTimeout(()=>{handleBiometricLogin();},500);return()=>clearTimeout(timer);}},[phone,isSupported,hasCredentials,isAuthenticating,error,handleBiometricLogin]);if(!isSupported){return null;// Don't show anything if not supported\n}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\",children:/*#__PURE__*/_jsx(\"p\",{children:error})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleBiometricLogin,disabled:isAuthenticating||!phone,className:\"w-full py-3 px-4 rounded-lg font-semibold transition-all \".concat(isAuthenticating||!phone?'bg-gray-300 text-gray-500 cursor-not-allowed':'bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 shadow-lg'),children:isAuthenticating?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 mr-3\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\",fill:\"none\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Authenticating...\"]}):/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"})}),\"Login with Fingerprint\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full border-t border-gray-300\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"relative flex justify-center text-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 bg-white text-gray-500\",children:\"or\"})})]}),onFallbackToPassword&&/*#__PURE__*/_jsx(\"button\",{onClick:onFallbackToPassword,className:\"w-full text-indigo-600 hover:text-indigo-700 font-medium text-sm\",children:\"Use password instead\"})]});};export default BiometricLogin;","map":{"version":3,"names":["React","useState","useEffect","useCallback","isPlatformAuthenticatorAvailable","authenticateWithBiometric","hasStoredCredentials","jsx","_jsx","jsxs","_jsxs","BiometricLogin","_ref","phone","onSuccess","onFallbackToPassword","isSupported","setIsSupported","isAuthenticating","setIsAuthenticating","error","setError","hasCredentials","setHasCredentials","checkSupport","available","stored","handleBiometricLogin","result","err","console","message","includes","timer","setTimeout","clearTimeout","className","children","onClick","disabled","concat","viewBox","cx","cy","r","stroke","strokeWidth","fill","d","strokeLinecap","strokeLinejoin"],"sources":["/home/aakash/Projects/Fraud-Detection-in-UPI---FDT2/frontend/src/components/BiometricLogin.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { \n  isPlatformAuthenticatorAvailable, \n  authenticateWithBiometric,\n  hasStoredCredentials \n} from '../utils/webauthn';\n\nconst BiometricLogin = ({ phone, onSuccess, onFallbackToPassword }) => {\n  const [isSupported, setIsSupported] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  const [error, setError] = useState(null);\n  const [hasCredentials, setHasCredentials] = useState(false);\n\n  useEffect(() => {\n    checkSupport();\n  }, []);\n\n  const checkSupport = async () => {\n    const available = await isPlatformAuthenticatorAvailable();\n    const stored = hasStoredCredentials();\n    setIsSupported(available);\n    setHasCredentials(stored);\n  };\n\n  const handleBiometricLogin = useCallback(async () => {\n    if (!phone) {\n      setError('Please enter your phone number first');\n      return;\n    }\n\n    setIsAuthenticating(true);\n    setError(null);\n\n    try {\n      const result = await authenticateWithBiometric(phone);\n      \n      if (onSuccess) {\n        onSuccess(result);\n      }\n    } catch (err) {\n      console.error('Biometric login error:', err);\n      \n      // Check if it's a \"not enabled\" error\n      if (err.message.includes('not enabled') || err.message.includes('No biometric')) {\n        setError('Biometric login not set up for this account');\n      } else {\n        setError(err.message || 'Fingerprint authentication failed');\n      }\n    } finally {\n      setIsAuthenticating(false);\n    }\n  }, [phone, onSuccess]);\n\n  // Auto-trigger biometric if credentials exist and phone is entered\n  useEffect(() => {\n    if (isSupported && hasCredentials && phone && !isAuthenticating && !error) {\n      // Small delay to avoid immediate trigger\n      const timer = setTimeout(() => {\n        handleBiometricLogin();\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [phone, isSupported, hasCredentials, isAuthenticating, error, handleBiometricLogin]);\n\n  if (!isSupported) {\n    return null; // Don't show anything if not supported\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n          <p>{error}</p>\n        </div>\n      )}\n\n      <button\n        onClick={handleBiometricLogin}\n        disabled={isAuthenticating || !phone}\n        className={`w-full py-3 px-4 rounded-lg font-semibold transition-all ${\n          isAuthenticating || !phone\n            ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n            : 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 shadow-lg'\n        }`}\n      >\n        {isAuthenticating ? (\n          <span className=\"flex items-center justify-center\">\n            <svg className=\"animate-spin h-5 w-5 mr-3\" viewBox=\"0 0 24 24\">\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n            </svg>\n            Authenticating...\n          </span>\n        ) : (\n          <span className=\"flex items-center justify-center\">\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n            </svg>\n            Login with Fingerprint\n          </span>\n        )}\n      </button>\n\n      <div className=\"relative\">\n        <div className=\"absolute inset-0 flex items-center\">\n          <div className=\"w-full border-t border-gray-300\"></div>\n        </div>\n        <div className=\"relative flex justify-center text-sm\">\n          <span className=\"px-2 bg-white text-gray-500\">or</span>\n        </div>\n      </div>\n\n      {onFallbackToPassword && (\n        <button\n          onClick={onFallbackToPassword}\n          className=\"w-full text-indigo-600 hover:text-indigo-700 font-medium text-sm\"\n        >\n          Use password instead\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default BiometricLogin;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CAC/D,OACEC,gCAAgC,CAChCC,yBAAyB,CACzBC,oBAAoB,KACf,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE3B,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAgD,IAA/C,CAAEC,KAAK,CAAEC,SAAS,CAAEC,oBAAqB,CAAC,CAAAH,IAAA,CAChE,KAAM,CAACI,WAAW,CAAEC,cAAc,CAAC,CAAGhB,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACiB,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAACmB,KAAK,CAAEC,QAAQ,CAAC,CAAGpB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACqB,cAAc,CAAEC,iBAAiB,CAAC,CAAGtB,QAAQ,CAAC,KAAK,CAAC,CAE3DC,SAAS,CAAC,IAAM,CACdsB,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAArB,gCAAgC,CAAC,CAAC,CAC1D,KAAM,CAAAsB,MAAM,CAAGpB,oBAAoB,CAAC,CAAC,CACrCW,cAAc,CAACQ,SAAS,CAAC,CACzBF,iBAAiB,CAACG,MAAM,CAAC,CAC3B,CAAC,CAED,KAAM,CAAAC,oBAAoB,CAAGxB,WAAW,CAAC,SAAY,CACnD,GAAI,CAACU,KAAK,CAAE,CACVQ,QAAQ,CAAC,sCAAsC,CAAC,CAChD,OACF,CAEAF,mBAAmB,CAAC,IAAI,CAAC,CACzBE,QAAQ,CAAC,IAAI,CAAC,CAEd,GAAI,CACF,KAAM,CAAAO,MAAM,CAAG,KAAM,CAAAvB,yBAAyB,CAACQ,KAAK,CAAC,CAErD,GAAIC,SAAS,CAAE,CACbA,SAAS,CAACc,MAAM,CAAC,CACnB,CACF,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACV,KAAK,CAAC,wBAAwB,CAAES,GAAG,CAAC,CAE5C;AACA,GAAIA,GAAG,CAACE,OAAO,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAIH,GAAG,CAACE,OAAO,CAACC,QAAQ,CAAC,cAAc,CAAC,CAAE,CAC/EX,QAAQ,CAAC,6CAA6C,CAAC,CACzD,CAAC,IAAM,CACLA,QAAQ,CAACQ,GAAG,CAACE,OAAO,EAAI,mCAAmC,CAAC,CAC9D,CACF,CAAC,OAAS,CACRZ,mBAAmB,CAAC,KAAK,CAAC,CAC5B,CACF,CAAC,CAAE,CAACN,KAAK,CAAEC,SAAS,CAAC,CAAC,CAEtB;AACAZ,SAAS,CAAC,IAAM,CACd,GAAIc,WAAW,EAAIM,cAAc,EAAIT,KAAK,EAAI,CAACK,gBAAgB,EAAI,CAACE,KAAK,CAAE,CACzE;AACA,KAAM,CAAAa,KAAK,CAAGC,UAAU,CAAC,IAAM,CAC7BP,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAAE,GAAG,CAAC,CACP,MAAO,IAAMQ,YAAY,CAACF,KAAK,CAAC,CAClC,CACF,CAAC,CAAE,CAACpB,KAAK,CAAEG,WAAW,CAAEM,cAAc,CAAEJ,gBAAgB,CAAEE,KAAK,CAAEO,oBAAoB,CAAC,CAAC,CAEvF,GAAI,CAACX,WAAW,CAAE,CAChB,MAAO,KAAI,CAAE;AACf,CAEA,mBACEN,KAAA,QAAK0B,SAAS,CAAC,WAAW,CAAAC,QAAA,EACvBjB,KAAK,eACJZ,IAAA,QAAK4B,SAAS,CAAC,2EAA2E,CAAAC,QAAA,cACxF7B,IAAA,MAAA6B,QAAA,CAAIjB,KAAK,CAAI,CAAC,CACX,CACN,cAEDZ,IAAA,WACE8B,OAAO,CAAEX,oBAAqB,CAC9BY,QAAQ,CAAErB,gBAAgB,EAAI,CAACL,KAAM,CACrCuB,SAAS,6DAAAI,MAAA,CACPtB,gBAAgB,EAAI,CAACL,KAAK,CACtB,8CAA8C,CAC9C,+GAA+G,CAClH,CAAAwB,QAAA,CAEFnB,gBAAgB,cACfR,KAAA,SAAM0B,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAChD3B,KAAA,QAAK0B,SAAS,CAAC,2BAA2B,CAACK,OAAO,CAAC,WAAW,CAAAJ,QAAA,eAC5D7B,IAAA,WAAQ4B,SAAS,CAAC,YAAY,CAACM,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAACC,MAAM,CAAC,cAAc,CAACC,WAAW,CAAC,GAAG,CAACC,IAAI,CAAC,MAAM,CAAE,CAAC,cAC1GvC,IAAA,SAAM4B,SAAS,CAAC,YAAY,CAACW,IAAI,CAAC,cAAc,CAACC,CAAC,CAAC,iHAAiH,CAAE,CAAC,EACpK,CAAC,oBAER,EAAM,CAAC,cAEPtC,KAAA,SAAM0B,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAChD7B,IAAA,QAAK4B,SAAS,CAAC,cAAc,CAACW,IAAI,CAAC,MAAM,CAACF,MAAM,CAAC,cAAc,CAACJ,OAAO,CAAC,WAAW,CAAAJ,QAAA,cACjF7B,IAAA,SAAMyC,aAAa,CAAC,OAAO,CAACC,cAAc,CAAC,OAAO,CAACJ,WAAW,CAAE,CAAE,CAACE,CAAC,CAAC,sGAAsG,CAAE,CAAC,CAC3K,CAAC,yBAER,EAAM,CACP,CACK,CAAC,cAETtC,KAAA,QAAK0B,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB7B,IAAA,QAAK4B,SAAS,CAAC,oCAAoC,CAAAC,QAAA,cACjD7B,IAAA,QAAK4B,SAAS,CAAC,iCAAiC,CAAM,CAAC,CACpD,CAAC,cACN5B,IAAA,QAAK4B,SAAS,CAAC,sCAAsC,CAAAC,QAAA,cACnD7B,IAAA,SAAM4B,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,IAAE,CAAM,CAAC,CACpD,CAAC,EACH,CAAC,CAELtB,oBAAoB,eACnBP,IAAA,WACE8B,OAAO,CAAEvB,oBAAqB,CAC9BqB,SAAS,CAAC,kEAAkE,CAAAC,QAAA,CAC7E,sBAED,CAAQ,CACT,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAA1B,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}