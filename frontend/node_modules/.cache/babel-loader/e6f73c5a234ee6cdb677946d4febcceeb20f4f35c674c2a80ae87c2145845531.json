{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate,Link}from'react-router-dom';import{submitUserDecision,getTransaction,confirmTransaction,cancelTransaction}from'../api';import{useNotifications}from'./NotificationSystem';import{formatAmount,getRiskColor,getRiskLabel}from'../utils/helpers';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FraudAlert=()=>{const{txId}=useParams();const navigate=useNavigate();const{addNotification}=useNotifications();const[transaction,setTransaction]=useState(null);const[loading,setLoading]=useState(true);const[processing,setProcessing]=useState(false);const[error,setError]=useState(null);useEffect(()=>{fetchTransaction();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[txId]);const fetchTransaction=async()=>{try{setLoading(true);setError(null);// First try to fetch from API\nconst response=await getTransaction(txId);if(response&&response.transaction){setTransaction(response.transaction);}else{setError('Transaction not found');}}catch(err){var _err$response,_err$response$data;console.error('Error fetching transaction:',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Failed to load transaction details');}finally{setLoading(false);}};const handleDecision=async decision=>{setProcessing(true);try{if(decision==='confirm'){await confirmTransaction(txId);}else if(decision==='cancel'){await cancelTransaction(txId);}else{await submitUserDecision({tx_id:txId,decision});}addNotification({type:'transaction_resolved',title:\"Transaction \".concat(decision==='confirm'?'Confirmed':'Cancelled'),message:\"Transaction to \".concat(transaction.recipient_vpa,\" has been \").concat(decision==='confirm'?'confirmed':'cancelled',\".\"),category:'success'});// Redirect back after a short delay\nsetTimeout(()=>{navigate('/dashboard');},1500);}catch(error){var _error$response,_error$response$data;console.error('Decision error:',error);addNotification({type:'error',title:'Action Failed',message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Unable to process your decision. Please try again.',category:'error'});}finally{setProcessing(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-white text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 border-4 border-purple-400 border-t-transparent rounded-full animate-spin mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl\",children:\"Analyzing transaction...\"})]})});}if(error||!transaction){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-white\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-24 h-24 mx-auto mb-6 text-red-400\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-2\",children:\"Transaction Not Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-300 mb-6\",children:error||'The transaction you\\'re looking for doesn\\'t exist or has been resolved.'}),/*#__PURE__*/_jsxs(Link,{to:\"/dashboard\",className:\"inline-flex items-center px-6 py-3 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 transition duration-200\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 19l-7-7 7-7\"})}),\"Back to Dashboard\"]})]})});}const riskLevel=getRiskColor(transaction.risk_score,transaction.risk_level);const riskLabel=getRiskLabel(transaction.risk_score,transaction.risk_level);// Determine action based on transaction status\nconst isDelayed=transaction.action==='DELAY'||transaction.db_status==='pending';const isBlocked=transaction.action==='BLOCK'||transaction.db_status==='blocked';return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-black/20 backdrop-blur-sm border-b border-white/10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-6xl mx-auto px-4 py-4\",children:/*#__PURE__*/_jsxs(Link,{to:\"/dashboard\",className:\"text-white/80 hover:text-white flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 19l-7-7 7-7\"})}),\"Back to Security Dashboard\"]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8 \".concat(riskLevel==='red'?'animate-pulse':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-flex items-center justify-center w-20 h-20 rounded-full mb-4 \".concat(riskLevel==='red'?'bg-red-500':riskLevel==='yellow'?'bg-amber-500':'bg-green-500'),children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-10 h-10 text-white\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:isBlocked?/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"}):/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"})})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold mb-2 \".concat(riskLevel==='red'?'text-red-400':riskLevel==='yellow'?'text-amber-400':'text-green-400'),children:isBlocked?'TRANSACTION BLOCKED':'TRANSACTION REQUIRES VERIFICATION'}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white/60 text-lg\",children:[\"Risk Level: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold \".concat(riskLevel==='red'?'text-red-400':riskLevel==='yellow'?'text-amber-400':'text-green-400'),children:riskLabel})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-8 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white mb-6\",children:\"Transaction Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/60 text-sm mb-2\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-white\",children:formatAmount(transaction.amount)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/60 text-sm mb-2\",children:\"Recipient\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-white\",children:transaction.recipient_vpa})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/60 text-sm mb-2\",children:\"Transaction ID\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-mono text-white/80\",children:transaction.tx_id})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/60 text-sm mb-2\",children:\"Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-white/80\",children:new Date(transaction.created_at+'Z').toLocaleString()})]})]}),transaction.remarks&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-black/20 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/60 text-sm mb-2\",children:\"Remarks\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white italic\",children:[\"\\\"\",transaction.remarks,\"\\\"\"]})]})]}),transaction.risk_factors&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-8 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white mb-6\",children:\"Risk Analysis\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:Object.entries(transaction.risk_factors).map(_ref=>{let[factor,analysis]=_ref;const[category,level]=analysis.split(' - ');const isHigh=level.includes('HIGH');const isMedium=level.includes('MEDIUM');return/*#__PURE__*/_jsx(\"div\",{className:\"border-l-4 p-4 rounded-r-lg \".concat(isHigh?'border-red-500 bg-red-500/10':isMedium?'border-amber-500 bg-amber-500/10':'border-green-500 bg-green-500/10'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full mr-3 \".concat(isHigh?'bg-red-500':isMedium?'bg-amber-500':'bg-green-500')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80 text-sm font-medium\",children:category.replace('_',' ').toUpperCase()}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/60 text-sm\",children:analysis})]})]})},factor);})})]}),transaction.fraud_reasons&&transaction.fraud_reasons.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-8 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white mb-4\",children:\"Why This Action Was Taken\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:transaction.fraud_reasons.map((reason,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start bg-white/5 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 text-amber-400 mr-3 mt-0.5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80\",children:reason})]},index))})]}),isDelayed&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleDecision('confirm'),disabled:processing,className:\"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold py-4 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none flex items-center justify-center\",children:[processing?/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin mr-3\"}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 mr-3\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 13l4 4L19 7\"})}),\"Confirm Transaction\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleDecision('cancel'),disabled:processing,className:\"flex-1 bg-gradient-to-r from-red-500 to-pink-600 text-white font-semibold py-4 px-8 rounded-xl hover:from-red-600 hover:to-pink-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none flex items-center justify-center\",children:[processing?/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin mr-3\"}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 mr-3\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})}),\"Cancel Transaction\"]})]}),isBlocked&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-500/10 border border-red-500/30 rounded-xl p-6 text-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-16 h-16 text-red-400 mx-auto mb-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-red-400 mb-2\",children:\"Transaction Blocked\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white/80 mb-4\",children:\"This transaction was blocked for your security. If you believe this is an error, please contact our support team immediately.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-4\",children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",className:\"flex-1 bg-white/20 text-white font-semibold py-3 px-6 rounded-xl hover:bg-white/30 transition duration-200 text-center\",children:\"Go to Dashboard\"}),/*#__PURE__*/_jsx(\"a\",{href:\"mailto:teamfdt2@gmail.com\",className:\"flex-1 bg-gradient-to-r from-red-500 to-pink-600 text-white font-semibold py-3 px-6 rounded-xl hover:from-red-600 hover:to-pink-700 transition duration-200 text-center\",children:\"Contact Support\"})]})]})]})]});};export default FraudAlert;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}