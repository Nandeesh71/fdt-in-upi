{"ast":null,"code":"import _objectWithoutProperties from\"C:/Users/jerol/OneDrive/Desktop/FDT_HOST/fdt-in-upi/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _objectSpread from\"C:/Users/jerol/OneDrive/Desktop/FDT_HOST/fdt-in-upi/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const _excluded=[\"confirmPassword\"];import React,{useState}from'react';import{Link,useNavigate}from'react-router-dom';import{registerUser}from'../api';import BiometricSetup from'./BiometricSetup';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RegisterScreen=_ref=>{let{onRegister}=_ref;const navigate=useNavigate();const[formData,setFormData]=useState({name:'',phone:'',email:'',password:'',confirmPassword:''});const[error,setError]=useState('');const[loading,setLoading]=useState(false);const[showPassword,setShowPassword]=useState(false);const[showConfirmPassword,setShowConfirmPassword]=useState(false);const[showBiometricSetup,setShowBiometricSetup]=useState(false);const[registeredUser,setRegisteredUser]=useState(null);const[registeredToken,setRegisteredToken]=useState(null);const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));setError('');};const handleBiometricComplete=()=>{// User completed biometric setup\nonRegister(registeredUser,registeredToken);navigate('/dashboard');};const handleBiometricSkip=()=>{// User skipped biometric setup\nonRegister(registeredUser,registeredToken);navigate('/dashboard');};// Show biometric setup screen after registration\nif(showBiometricSetup){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center p-4\",children:/*#__PURE__*/_jsx(BiometricSetup,{onComplete:handleBiometricComplete,onSkip:handleBiometricSkip})});}const handleSubmit=async e=>{e.preventDefault();setError('');if(formData.password!==formData.confirmPassword){setError('Passwords do not match');return;}if(formData.password.length<6){setError('Password must be at least 6 characters');return;}setLoading(true);try{const{confirmPassword}=formData,userData=_objectWithoutProperties(formData,_excluded);const response=await registerUser(userData);if(response.status==='success'){// Store user data and show biometric setup\nsetRegisteredUser(response.user);setRegisteredToken(response.token);// IMPORTANT: Save token to localStorage before showing BiometricSetup\n// BiometricSetup needs the token to register credentials with the backend\n// Using localStorage ensures token persists across app restarts for future biometric unlocks\nlocalStorage.setItem('fdt_token',response.token);localStorage.setItem('fdt_user',JSON.stringify(response.user));setShowBiometricSetup(true);}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Registration failed. Please try again.');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 fade-in\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 mx-auto bg-indigo-100 rounded-full flex items-center justify-center mb-4\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-10 h-10 text-indigo-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z\"})})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Create Account\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Join FDT for secure transactions\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleChange,placeholder:\"Enter your full name\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",required:true,\"data-testid\":\"register-name-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",value:formData.phone,onChange:handleChange,placeholder:\"+91XXXXXXXXXX\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",required:true,\"data-testid\":\"register-phone-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Email (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleChange,placeholder:\"your@email.com\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",\"data-testid\":\"register-email-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:showPassword?\"text\":\"password\",name:\"password\",value:formData.password,onChange:handleChange,placeholder:\"Minimum 8 characters with a number\",className:\"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",required:true,\"data-testid\":\"register-password-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPassword(!showPassword),className:\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\",title:showPassword?\"Hide password\":\"Show password\",children:showPassword?/*#__PURE__*/// Eye icon (visible)\n_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M10 12a2 2 0 100-4 2 2 0 000 4z\"}),/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z\",clipRule:\"evenodd\"})]}):/*#__PURE__*/// Eye-slash icon (hidden)\n_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z\",clipRule:\"evenodd\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Confirm Password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:showConfirmPassword?\"text\":\"password\",name:\"confirmPassword\",value:formData.confirmPassword,onChange:handleChange,placeholder:\"Re-enter password\",className:\"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\",required:true,\"data-testid\":\"register-confirm-password-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowConfirmPassword(!showConfirmPassword),className:\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\",title:showConfirmPassword?\"Hide password\":\"Show password\",children:showConfirmPassword?/*#__PURE__*/// Eye icon (visible)\n_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M10 12a2 2 0 100-4 2 2 0 000 4z\"}),/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z\",clipRule:\"evenodd\"})]}):/*#__PURE__*/// Eye-slash icon (hidden)\n_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z\",clipRule:\"evenodd\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z\"})]})})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition duration-200 disabled:bg-gray-400 mt-6\",\"data-testid\":\"register-submit-button\",children:loading?'Creating Account...':'Create Account'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 text-center\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Already have an account?\",' ',/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"text-indigo-600 font-semibold hover:text-indigo-700\",children:\"Sign In\"})]})})]})});};export default RegisterScreen;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}