{"ast":null,"code":"import _objectSpread from\"/home/aakash/Projects/Fraud-Detection-in-UPI---FDT2/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,createContext,useContext,useCallback}from'react';import{getUserTransactions}from'../api';import{jsx as _jsx}from\"react/jsx-runtime\";const NotificationContext=/*#__PURE__*/createContext();export const useNotifications=()=>{const context=useContext(NotificationContext);if(!context){throw new Error('useNotifications must be used within a NotificationProvider');}return context;};export const NotificationProvider=_ref=>{let{children}=_ref;const[notifications,setNotifications]=useState([]);const[showNotificationPanel,setShowNotificationPanel]=useState(false);const addNotification=useCallback(notification=>{const id=Date.now()+Math.random();const newNotification=_objectSpread({id,timestamp:new Date(),read:false},notification);setNotifications(prev=>[newNotification,...prev]);// Auto-remove temporary notifications after 10 seconds\nif(notification.type!=='delayed_transaction'){setTimeout(()=>{setNotifications(prev=>prev.filter(n=>n.id!==id));},10000);}},[]);const removeNotification=useCallback(id=>{setNotifications(prev=>prev.filter(n=>n.id!==id));},[]);const markAsRead=useCallback(id=>{setNotifications(prev=>prev.map(n=>n.id===id?_objectSpread(_objectSpread({},n),{},{read:true}):n));},[]);const clearAll=useCallback(()=>{setNotifications([]);},[]);// Check for delayed transactions periodically (only if user is authenticated)\nuseEffect(()=>{// Only check if user is logged in (has token)\nconst token=localStorage.getItem('fdt_token');if(!token){return;// Skip if not authenticated\n}const checkDelayedTransactions=async()=>{try{const data=await getUserTransactions(20,'DELAY');const delayedTxns=data.transactions||[];delayedTxns.forEach(tx=>{const existingNotification=notifications.find(n=>n.type==='delayed_transaction'&&n.transactionId===tx.tx_id&&n.read===false);if(!existingNotification){addNotification({type:'delayed_transaction',title:'Transaction Pending Verification',message:\"Transaction of \\u20B9\".concat(tx.amount,\" to \").concat(tx.recipient_vpa,\" needs your confirmation\"),transactionId:tx.tx_id,action:'review',actionText:'Review Now',actionUrl:\"/fraud-alert/\".concat(tx.tx_id)});}});}catch(err){console.error('Failed to check delayed transactions:',err);}};// Check immediately and then every 30 seconds\ncheckDelayedTransactions();const interval=setInterval(checkDelayedTransactions,30000);return()=>clearInterval(interval);},[notifications,addNotification]);const unreadCount=notifications.filter(n=>!n.read).length;return/*#__PURE__*/_jsx(NotificationContext.Provider,{value:{notifications,addNotification,removeNotification,markAsRead,clearAll,showNotificationPanel,setShowNotificationPanel,unreadCount},children:children});};export default NotificationContext;","map":{"version":3,"names":["React","useState","useEffect","createContext","useContext","useCallback","getUserTransactions","jsx","_jsx","NotificationContext","useNotifications","context","Error","NotificationProvider","_ref","children","notifications","setNotifications","showNotificationPanel","setShowNotificationPanel","addNotification","notification","id","Date","now","Math","random","newNotification","_objectSpread","timestamp","read","prev","type","setTimeout","filter","n","removeNotification","markAsRead","map","clearAll","token","localStorage","getItem","checkDelayedTransactions","data","delayedTxns","transactions","forEach","tx","existingNotification","find","transactionId","tx_id","title","message","concat","amount","recipient_vpa","action","actionText","actionUrl","err","console","error","interval","setInterval","clearInterval","unreadCount","length","Provider","value"],"sources":["/home/aakash/Projects/Fraud-Detection-in-UPI---FDT2/frontend/src/components/NotificationSystem.js"],"sourcesContent":["import React, { useState, useEffect, createContext, useContext, useCallback } from 'react';\nimport { getUserTransactions } from '../api';\n\nconst NotificationContext = createContext();\n\nexport const useNotifications = () => {\n  const context = useContext(NotificationContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within a NotificationProvider');\n  }\n  return context;\n};\n\nexport const NotificationProvider = ({ children }) => {\n  const [notifications, setNotifications] = useState([]);\n  const [showNotificationPanel, setShowNotificationPanel] = useState(false);\n\n  const addNotification = useCallback((notification) => {\n    const id = Date.now() + Math.random();\n    const newNotification = {\n      id,\n      timestamp: new Date(),\n      read: false,\n      ...notification\n    };\n    \n    setNotifications(prev => [newNotification, ...prev]);\n    \n    // Auto-remove temporary notifications after 10 seconds\n    if (notification.type !== 'delayed_transaction') {\n      setTimeout(() => {\n        setNotifications(prev => prev.filter(n => n.id !== id));\n      }, 10000);\n    }\n  }, []);\n\n  const removeNotification = useCallback((id) => {\n    setNotifications(prev => prev.filter(n => n.id !== id));\n  }, []);\n\n  const markAsRead = useCallback((id) => {\n    setNotifications(prev => \n      prev.map(n => n.id === id ? { ...n, read: true } : n)\n    );\n  }, []);\n\n  const clearAll = useCallback(() => {\n    setNotifications([]);\n  }, []);\n\n  // Check for delayed transactions periodically (only if user is authenticated)\n  useEffect(() => {\n    // Only check if user is logged in (has token)\n    const token = localStorage.getItem('fdt_token');\n    if (!token) {\n      return; // Skip if not authenticated\n    }\n\n    const checkDelayedTransactions = async () => {\n      try {\n        const data = await getUserTransactions(20, 'DELAY');\n        const delayedTxns = data.transactions || [];\n        \n        delayedTxns.forEach(tx => {\n          const existingNotification = notifications.find(\n            n => n.type === 'delayed_transaction' && n.transactionId === tx.tx_id && n.read === false\n          );\n          \n          if (!existingNotification) {\n            addNotification({\n              type: 'delayed_transaction',\n              title: 'Transaction Pending Verification',\n              message: `Transaction of â‚¹${tx.amount} to ${tx.recipient_vpa} needs your confirmation`,\n              transactionId: tx.tx_id,\n              action: 'review',\n              actionText: 'Review Now',\n              actionUrl: `/fraud-alert/${tx.tx_id}`\n            });\n          }\n        });\n      } catch (err) {\n        console.error('Failed to check delayed transactions:', err);\n      }\n    };\n\n    // Check immediately and then every 30 seconds\n    checkDelayedTransactions();\n    const interval = setInterval(checkDelayedTransactions, 30000);\n\n    return () => clearInterval(interval);\n  }, [notifications, addNotification]);\n\n  const unreadCount = notifications.filter(n => !n.read).length;\n\n  return (\n    <NotificationContext.Provider\n      value={{\n        notifications,\n        addNotification,\n        removeNotification,\n        markAsRead,\n        clearAll,\n        showNotificationPanel,\n        setShowNotificationPanel,\n        unreadCount\n      }}\n    >\n      {children}\n    </NotificationContext.Provider>\n  );\n};\n\nexport default NotificationContext;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}