{"ast":null,"code":"var _jsxFileName = \"/home/aakash/Projects/Fraud-Detection-in-UPI---FDT2/frontend/src/components/BiometricLogin.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { isPlatformAuthenticatorAvailable, authenticateWithBiometric, hasStoredCredentials } from '../utils/webauthn';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BiometricLogin = ({\n  phone,\n  onSuccess,\n  onFallbackToPassword\n}) => {\n  _s();\n  const [isSupported, setIsSupported] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  const [error, setError] = useState(null);\n  const [hasCredentials, setHasCredentials] = useState(false);\n  useEffect(() => {\n    checkSupport();\n  }, []);\n  const checkSupport = async () => {\n    const available = await isPlatformAuthenticatorAvailable();\n    const stored = hasStoredCredentials();\n    setIsSupported(available);\n    setHasCredentials(stored);\n  };\n  const handleBiometricLogin = useCallback(async () => {\n    if (!phone) {\n      setError('Please enter your phone number first');\n      return;\n    }\n    setIsAuthenticating(true);\n    setError(null);\n    try {\n      const result = await authenticateWithBiometric(phone);\n      if (onSuccess) {\n        onSuccess(result);\n      }\n    } catch (err) {\n      console.error('Biometric login error:', err);\n\n      // Check if it's a \"not enabled\" error\n      if (err.message.includes('not enabled') || err.message.includes('No biometric')) {\n        setError('Biometric login not set up for this account');\n      } else {\n        setError(err.message || 'Fingerprint authentication failed');\n      }\n    } finally {\n      setIsAuthenticating(false);\n    }\n  }, [phone, onSuccess]);\n\n  // Auto-trigger biometric if credentials exist and phone is entered\n  useEffect(() => {\n    if (isSupported && hasCredentials && phone && !isAuthenticating && !error) {\n      // Small delay to avoid immediate trigger\n      const timer = setTimeout(() => {\n        handleBiometricLogin();\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [phone, isSupported, hasCredentials, isAuthenticating, error, handleBiometricLogin]);\n  if (!isSupported) {\n    return null; // Don't show anything if not supported\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-4\",\n    children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleBiometricLogin,\n      disabled: isAuthenticating || !phone,\n      className: `w-full py-3 px-4 rounded-lg font-semibold transition-all ${isAuthenticating || !phone ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 shadow-lg'}`,\n      children: isAuthenticating ? /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"flex items-center justify-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"animate-spin h-5 w-5 mr-3\",\n          viewBox: \"0 0 24 24\",\n          children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n            className: \"opacity-25\",\n            cx: \"12\",\n            cy: \"12\",\n            r: \"10\",\n            stroke: \"currentColor\",\n            strokeWidth: \"4\",\n            fill: \"none\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            className: \"opacity-75\",\n            fill: \"currentColor\",\n            d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), \"Authenticating...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"flex items-center justify-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"w-5 h-5 mr-2\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this), \"Login with Fingerprint\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0 flex items-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full border-t border-gray-300\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative flex justify-center text-sm\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"px-2 bg-white text-gray-500\",\n          children: \"or\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), onFallbackToPassword && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onFallbackToPassword,\n      className: \"w-full text-indigo-600 hover:text-indigo-700 font-medium text-sm\",\n      children: \"Use password instead\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n_s(BiometricLogin, \"/myWB/pt4P816FLhrNfk9N43Row=\");\n_c = BiometricLogin;\nexport default BiometricLogin;\nvar _c;\n$RefreshReg$(_c, \"BiometricLogin\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","isPlatformAuthenticatorAvailable","authenticateWithBiometric","hasStoredCredentials","jsxDEV","_jsxDEV","BiometricLogin","phone","onSuccess","onFallbackToPassword","_s","isSupported","setIsSupported","isAuthenticating","setIsAuthenticating","error","setError","hasCredentials","setHasCredentials","checkSupport","available","stored","handleBiometricLogin","result","err","console","message","includes","timer","setTimeout","clearTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","viewBox","cx","cy","r","stroke","strokeWidth","fill","d","strokeLinecap","strokeLinejoin","_c","$RefreshReg$"],"sources":["/home/aakash/Projects/Fraud-Detection-in-UPI---FDT2/frontend/src/components/BiometricLogin.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { \n  isPlatformAuthenticatorAvailable, \n  authenticateWithBiometric,\n  hasStoredCredentials \n} from '../utils/webauthn';\n\nconst BiometricLogin = ({ phone, onSuccess, onFallbackToPassword }) => {\n  const [isSupported, setIsSupported] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  const [error, setError] = useState(null);\n  const [hasCredentials, setHasCredentials] = useState(false);\n\n  useEffect(() => {\n    checkSupport();\n  }, []);\n\n  const checkSupport = async () => {\n    const available = await isPlatformAuthenticatorAvailable();\n    const stored = hasStoredCredentials();\n    setIsSupported(available);\n    setHasCredentials(stored);\n  };\n\n  const handleBiometricLogin = useCallback(async () => {\n    if (!phone) {\n      setError('Please enter your phone number first');\n      return;\n    }\n\n    setIsAuthenticating(true);\n    setError(null);\n\n    try {\n      const result = await authenticateWithBiometric(phone);\n      \n      if (onSuccess) {\n        onSuccess(result);\n      }\n    } catch (err) {\n      console.error('Biometric login error:', err);\n      \n      // Check if it's a \"not enabled\" error\n      if (err.message.includes('not enabled') || err.message.includes('No biometric')) {\n        setError('Biometric login not set up for this account');\n      } else {\n        setError(err.message || 'Fingerprint authentication failed');\n      }\n    } finally {\n      setIsAuthenticating(false);\n    }\n  }, [phone, onSuccess]);\n\n  // Auto-trigger biometric if credentials exist and phone is entered\n  useEffect(() => {\n    if (isSupported && hasCredentials && phone && !isAuthenticating && !error) {\n      // Small delay to avoid immediate trigger\n      const timer = setTimeout(() => {\n        handleBiometricLogin();\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [phone, isSupported, hasCredentials, isAuthenticating, error, handleBiometricLogin]);\n\n  if (!isSupported) {\n    return null; // Don't show anything if not supported\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n          <p>{error}</p>\n        </div>\n      )}\n\n      <button\n        onClick={handleBiometricLogin}\n        disabled={isAuthenticating || !phone}\n        className={`w-full py-3 px-4 rounded-lg font-semibold transition-all ${\n          isAuthenticating || !phone\n            ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n            : 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 shadow-lg'\n        }`}\n      >\n        {isAuthenticating ? (\n          <span className=\"flex items-center justify-center\">\n            <svg className=\"animate-spin h-5 w-5 mr-3\" viewBox=\"0 0 24 24\">\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n            </svg>\n            Authenticating...\n          </span>\n        ) : (\n          <span className=\"flex items-center justify-center\">\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n            </svg>\n            Login with Fingerprint\n          </span>\n        )}\n      </button>\n\n      <div className=\"relative\">\n        <div className=\"absolute inset-0 flex items-center\">\n          <div className=\"w-full border-t border-gray-300\"></div>\n        </div>\n        <div className=\"relative flex justify-center text-sm\">\n          <span className=\"px-2 bg-white text-gray-500\">or</span>\n        </div>\n      </div>\n\n      {onFallbackToPassword && (\n        <button\n          onClick={onFallbackToPassword}\n          className=\"w-full text-indigo-600 hover:text-indigo-700 font-medium text-sm\"\n        >\n          Use password instead\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default BiometricLogin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}